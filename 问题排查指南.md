# 问题排查指南

本文档专注于常见问题的原因分析和解决方案。

> 📋 需要检查接口实现？查看 [API 接口检查](./API接口检查.md)  
> 📖 需要调试步骤？查看 [调试步骤](./调试步骤.md)

## 常见问题原因（按优先级排序）

### 🔴 最可能的原因 1：后端服务未启动或无法访问

**可能性**: ⭐⭐⭐⭐⭐ (最高)

**问题描述**:

- Vite 代理配置指向 `http://localhost:8080`
- 如果后端服务未运行，所有 API 请求都会失败
- 浏览器会显示 `ERR_CONNECTION_REFUSED` 错误

**检查方法**:

1. 确认后端服务是否在 `localhost:8080` 运行
2. 在浏览器中访问 `http://localhost:8080` 测试
3. 查看浏览器控制台是否有 `ERR_CONNECTION_REFUSED` 错误
4. 查看 Network 标签中请求状态是否为 `failed`

**解决方案**:

1. 启动后端服务
2. 确认后端服务运行在 `localhost:8080` 端口
3. 如果后端运行在其他端口，修改 `vite.config.js` 中的代理配置

### 🟡 原因 2：Token 认证问题

**可能性**: ⭐⭐⭐⭐

**问题描述**:

- Token 未正确存储或已过期
- 后端返回 401 Unauthorized 错误
- 请求 Headers 中缺少 Authorization header

**检查方法**:

1. 打开浏览器开发者工具 → Application → Local Storage
2. 检查是否存在 `token` 和 `user` 键
3. 检查 token 是否为空或无效
4. 查看 Network 标签中请求的 Headers，确认是否有 `Authorization: Bearer ...` header
5. 查看控制台是否有 401 错误

**解决方案**:

1. 清除 LocalStorage 中的 token 和 user
2. 重新登录
3. 检查登录接口是否正常返回 token
4. 如果 token 过期，重新登录获取新 token

### 🟡 原因 3：环境配置差异

**可能性**: ⭐⭐⭐

**问题描述**:

- 不同开发环境可能有不同的配置
- 后端服务地址或端口不同
- 代理配置不同

**检查方法**:

1. 对比 `vite.config.js` 中的代理配置
2. 检查是否有 `.env` 文件，内容是否一致
3. 确认后端服务地址是否一致
4. 检查端口号是否一致

**解决方案**:

1. 统一环境配置
2. 使用环境变量管理配置
3. 创建 `.env.example` 文件作为模板
4. 确保所有开发者使用相同的配置

### 🟡 原因 4：网络/CORS 问题

**可能性**: ⭐⭐

**问题描述**:

- 虽然通过 Vite 代理应该不会有 CORS 问题，但在某些情况下可能仍然出现
- 网络连接问题

**检查方法**:

1. 查看浏览器控制台是否有 CORS 错误
2. 检查 Network 标签中请求的响应头
3. 确认后端 CORS 配置是否正确
4. 测试网络连接是否正常

**解决方案**:

1. 检查后端 CORS 配置
2. 确认代理配置正确
3. 检查网络连接
4. 如果使用 VPN，尝试关闭 VPN 测试

### 🟡 原因 5：请求超时

**可能性**: ⭐

**问题描述**:

- 请求超时时间设置为 10 秒
- 如果后端响应慢可能超时

**检查方法**:

1. 查看 Network 标签中请求的状态
2. 检查是否有超时错误
3. 查看后端日志，确认响应时间

**解决方案**:

1. 增加请求超时时间（在 `src/api/request.js` 中修改 `timeout` 值）
2. 优化后端响应时间
3. 检查后端是否有性能问题

## 常见错误及解决方案

### 错误 1: ERR_CONNECTION_REFUSED

**原因**: 后端服务未运行  
**解决方案**: 启动后端服务，确认运行在 `localhost:8080`

### 错误 2: 401 Unauthorized

**原因**: Token 无效或已过期  
**解决方案**: 重新登录，获取新的 token

### 错误 3: 404 Not Found

**原因**: 接口路径错误或后端路由未配置  
**解决方案**: 检查接口路径，确认后端路由配置正确，参考 [API 接口检查](./API接口检查.md)

### 错误 4: CORS error

**原因**: 跨域问题（虽然通过代理应该不会有）  
**解决方案**: 检查代理配置，确认后端 CORS 配置正确

### 错误 5: 网络连接失败

**原因**: 网络问题或后端服务无法访问  
**解决方案**: 检查网络连接，确认后端服务可访问
